(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.ItemManager=function(){function e(e){this.ref=e,this.checkAllVideos=t(this.checkAllVideos,this),this.onPlayerStateChange=t(this.onPlayerStateChange,this),this.onPlayerReady=t(this.onPlayerReady,this),this.onYouTubeIframeAPIReady=t(this.onYouTubeIframeAPIReady,this),this.onDataLoaded=t(this.onDataLoaded,this),this.loadItems=t(this.loadItems,this),this.initItems=t(this.initItems,this),this.b=$("body"),this.dom_items=this.ref.find(".js-ytItem"),this.videos=[],this.items=[],this.playerList=[],this.initItems()}return e.prototype.initItems=function(){var t,e,i,s,a,o,r,n,h,l;for(e=h=0,l=this.dom_items.length;l>=0?l>h:h>l;e=l>=0?++h:--h)t=$(this.dom_items[e]),r=t.attr("data-type"),n=t.attr("data-videoid"),a=t.attr("data-playlist"),o=null!=t.attr("data-size")?window.helpers.covertDataSize(t.attr("data-size")):"no-size",i=t.hasClass("hasImage")?!0:!1,s=t.hasClass("hasTitle")?!0:!1,this.videos.push(n),this.items.push({item:t,videoId:n,playlistId:a,type:r,size:o,hasImage:i,hasTitle:s});return this.loadItems()},e.prototype.loadItems=function(){return $.ajax({type:"GET",url:window.helpers.getReqVideosListUrl(),dataType:"jsonp",data:{part:"id, snippet, contentDetails",id:this.videos.join(),key:window.helpers.getAPIkey()},success:function(t){return function(e){return null!==e?t.onDataLoaded(e):void 0}}(this),error:function(t){return console.log(t.message)}})},e.prototype.onDataLoaded=function(t){var e,i,s,a,o,r,n,h,l,d,p,y,u,m,c,I,f,g,v,w,P;for(r=t.items,a=m=0,g=r.length;g>=0?g>m:m>g;a=g>=0?++m:--m)for(p=r[a],o=p.id,h=p.snippet,i=h.description,d=h.title,l=h.thumbnails,e=p.contentDetails,s=window.helpers.convertISOtoDuration(e.duration),n=f=0,v=this.items.length;v>=0?v>f:f>v;n=v>=0?++f:--f)if(I=this.items[n].item,c=this.items[n].videoId,P=this.items[n].type,y=this.items[n].hasImage,u=this.items[n].hasTitle,w=this.items[n].size,c===o)switch(u||I.find(".js-ytItem__title").html(d),P){case"image":y||"no-size"!==w&&(null!=l[""+this.items[n].size]?I.find(".ytItem__image >img").attr("src",l[""+this.items[n].size].url):I.find(".ytItem__image >img").attr("src",l.medium.url)),I.find(".js-ytItem__counter").html(s);break;case"video":I.data("is-playing","false"),this.playerList.push({videoId:c,playerId:I.find(".js-player").attr("id"),autoPlay:I.hasClass("js-autoplay")?1:0})}return this.playerList.length>0&&(window.helpers.createPlayerAPI(),window.onYouTubeIframeAPIReady=this.onYouTubeIframeAPIReady),window.helpers.setIframeHeight()},e.prototype.onYouTubeIframeAPIReady=function(){var t,e,i,s,a;for(a=[],t=i=0,s=this.playerList.length;s>=0?s>i:i>s;t=s>=0?++i:--i)e=new YT.Player(this.playerList[t].playerId,{height:"100%",width:"100%",videoId:this.playerList[t].videoId,playerVars:{controls:1,rel:0,showinfo:0,cc_load_policy:0,autoplay:0},events:{onReady:this.onPlayerReady,onStateChange:this.onPlayerStateChange}}),a.push(this.playerList[t].playerYT=e);return a},e.prototype.onPlayerReady=function(){},e.prototype.onPlayerStateChange=function(t){var e;return e=$(t.target.getIframe()).attr("id"),1===t.data?($(t.target.getIframe()).data("is-playing","true"),this.checkAllVideos(e)):void 0},e.prototype.checkAllVideos=function(t){var e,i,s,a,o;for(o=[],e=s=0,a=this.playerList.length;a>=0?a>s:s>a;e=a>=0?++s:--s)this.playerList[e].playerId!==t?(i=$("#"+this.playerList[e].playerId),"true"===i.data("is-playing")?(i.data("is-playing","false"),o.push(this.playerList[e].playerYT.pauseVideo())):o.push(void 0)):o.push(void 0);return o},e}()}).call(this);