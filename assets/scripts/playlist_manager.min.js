(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.PlaylistManager=function(){function e(e){this.ref=e,this.onPlayerReady=t(this.onPlayerReady,this),this.onPlayerStateChange=t(this.onPlayerStateChange,this),this.updateDom=t(this.updateDom,this),this.updateCarousel=t(this.updateCarousel,this),this.updateTexts=t(this.updateTexts,this),this.updateThumbs=t(this.updateThumbs,this),this.setControls=t(this.setControls,this),this.onYouTubeIframeAPIReady=t(this.onYouTubeIframeAPIReady,this),this.createCarousel=t(this.createCarousel,this),this.createPlayer=t(this.createPlayer,this),this.onVideosLoaded=t(this.onVideosLoaded,this),this.loadVideosInDetails=t(this.loadVideosInDetails,this),this.onPlaylistLoaded=t(this.onPlaylistLoaded,this),this.initPlaylist=t(this.initPlaylist,this),this.max=50,this.videos=[],this.b=$("body"),this.next=$(".videoPaginator__next"),this.prev=$(".videoPaginator__previous"),this.title=$(".js-ytItem__title"),this.description=$(".js-ytItem__description"),this.carousel_ref=$(".js-carousel"),this.carousel=this.carousel_ref.find(".row--sliderAux ul"),this.has_no_playlist=this.ref.hasClass("noPlaylist"),this.videoId=this.ref.attr("data-videoid"),this.playlistId=this.ref.attr("data-playlist"),this.playerId=this.ref.find(".js-player").attr("id"),this.index=0,this.playlistItems=[],this.has_no_playlist?(this.videos.push(this.videoId),this.next.hide(),this.prev.hide(),this.loadVideosInDetails()):this.initPlaylist()}return e.prototype.initPlaylist=function(){return $.ajax({type:"GET",url:window.helpers.getReqPlaylistItemsUrl(),dataType:"jsonp",data:{part:"contentDetails",playlistId:this.playlistId,key:window.helpers.getAPIkey(),maxResults:this.max},success:function(t){return function(e){return null!==e?t.onPlaylistLoaded(e):void 0}}(this),error:function(t){return console.log(t.message)}})},e.prototype.onPlaylistLoaded=function(t){var e,i,s,a,n,o;for(s=t.items,e=n=0,o=s.length;o>=0?o>n:n>o;e=o>=0?++n:--n)a=s[e],i=a.contentDetails.videoId,this.videos.push(i);return this.loadVideosInDetails()},e.prototype.loadVideosInDetails=function(){return $.ajax({type:"GET",url:window.helpers.getReqVideosListUrl(),dataType:"jsonp",data:{part:"id, snippet, contentDetails",id:this.videos.join(),key:window.helpers.getAPIkey()},success:function(t){return function(e){return null!==e?t.onVideosLoaded(e):void 0}}(this),error:function(t){return console.log(t.message)}})},e.prototype.onVideosLoaded=function(t){var e,i,s,a,n,o,l,r,d,h,u,p;for(o=t.items,a=u=0,p=o.length;p>=0?p>u:u>p;a=p>=0?++u:--u)h=o[a],n=h.id,l=h.snippet,i=l.description,d=l.title,r=l.thumbnails,e=h.contentDetails,s=window.helpers.convertISOtoDuration(e.duration),n===this.videoId&&(this.index=a),this.playlistItems.push({videoId:n,title:d,description:i,thumbnails:r,duration:s});return this.has_no_playlist||this.createCarousel(),this.createPlayer(),window.helpers.setIframeHeight()},e.prototype.createPlayer=function(){return window.helpers.createPlayerAPI(),window.onYouTubeIframeAPIReady=this.onYouTubeIframeAPIReady},e.prototype.createCarousel=function(){var t,e,i,s,a;for(t=this.carousel.find(".js-carousel__item"),this.totalItems=this.playlistItems.length,i=s=0,a=this.playlistItems.length;a>=0?a>s:s>a;i=a>=0?++s:--s)e=t.clone().appendTo(this.carousel),e.attr("data-videoid",""+this.playlistItems[i].videoId),e.find(".ytItem__image >img").attr("src",""+this.playlistItems[i].thumbnails.medium.url),e.find(".js-ytItem__counter").html(""+this.playlistItems[i].duration),e.find(".js-ytItem__title").html(""+this.playlistItems[i].title),e.click(function(t){return function(e){var i,s;return e.preventDefault(),i=$(e.currentTarget),i.hasClass("is-playing")?void 0:(s=i.attr("data-videoid"),t.index=t.carousel.find(">li").index(i),t.player.loadVideoById(t.playlistItems[t.index].videoId),t.updateDom())}}(this));return t.remove(),new Carousel(this.carousel_ref)},e.prototype.onYouTubeIframeAPIReady=function(){return this.player=new YT.Player(this.playerId,{height:"100%",width:"100%",videoId:this.videoId,playerVars:{controls:1,rel:0,showinfo:0,cc_load_policy:0,autoplay:0,enablejsapi:1},events:{onReady:this.onPlayerReady,onStateChange:this.onPlayerStateChange}}),this.has_no_playlist?this.updateTexts():(this.setControls(),this.updateDom())},e.prototype.setControls=function(){return this.next.click(function(t){return function(e){return e.preventDefault(),t.index=t.index+1===t.playlistItems.length?0:t.index+1,t.player.loadVideoById(t.playlistItems[t.index].videoId),t.updateDom()}}(this)),this.prev.click(function(t){return function(e){return e.preventDefault(),t.index=t.index-1===-1?t.playlistItems.length-1:t.index-1,t.player.loadVideoById(t.playlistItems[t.index].videoId),t.updateDom()}}(this))},e.prototype.updateThumbs=function(){var t,e;return e=0===this.index?this.playlistItems.length-1:this.index-1,t=this.index===this.playlistItems.length-1?0:this.index+1,this.next.find(".videoPaginator__thumb >img").attr("src",this.playlistItems[t].thumbnails.medium.url),this.prev.find(".videoPaginator__thumb >img").attr("src",this.playlistItems[e].thumbnails.medium.url)},e.prototype.updateTexts=function(){return this.title.html(this.playlistItems[this.index].title),""===this.playlistItems[this.index].description||null==this.playlistItems[this.index].description?this.description.hide():(this.description.show(),this.description.html(this.playlistItems[this.index].description))},e.prototype.updateCarousel=function(){var t,e,i,s,a,n;for(e=this.carousel.find(".js-carousel__item"),n=[],i=s=0,a=e.length;a>=0?a>s:s>a;i=a>=0?++s:--s)t=$(e[i]),t.attr("data-videoid")===this.playlistItems[this.index].videoId?n.push(t.addClass("is-playing")):n.push(t.removeClass("is-playing"));return n},e.prototype.updateDom=function(){return this.updateThumbs(),this.updateTexts(),this.updateCarousel(),window.helpers.setIframeHeight()},e.prototype.onPlayerStateChange=function(){},e.prototype.onPlayerReady=function(){},e}()}).call(this);